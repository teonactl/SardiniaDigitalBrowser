

<DrawerClickableItem@MDNavigationDrawerItem>
    focus_color: "#e7e4c0"
    text_color: "#4a4939"
    icon_color: "#4a4939"
    ripple_color: "#c5bdd2"
    selected_color: "#0c6c4d"


<DrawerLabelItem@MDNavigationDrawerItem>
    text_color: "#4a4939"
    icon_color: "#4a4939"
    focus_behavior: False
    selected_color: "#4a4939"
    _no_ripple_effect: True

<MainScreen>:
    MDBoxLayout:
        id : main_box
        orientation: "vertical"
        tabs: tabs.__self__

        #adaptive_height : True
        #size_hint_y : 1
        MDTopAppBar:
            padding : 0
            id : topbar
            auto_bring_to_front: True

            pos_hint: {"top": 1}
            #elevation: 4
            left_action_items: [["menu", lambda x: nav_drawer.set_state("open")]] if screen_manager.current =="bro_screen" or screen_manager.current =="pre_screen"  else [["arrow-left", lambda x:app.go_back()]]
            right_action_items : [["magnify", lambda z : app.search_prompt()]]

        MDTabs:
            on_tab_switch: app.tab_switch(*args)
            size_hint_y: None
            height: dp(50)
            tab_indicator_type : "round" 
            id : tabs
            Tab:            
                title: "Tutti"
                id : tutti
            Tab:
                title: "Video"
                id: video
            Tab:
                title: "Immagini"
                id: immagini
            Tab:
                title: "Audio"
                id : audio
            Tab:
                title: "Testi"
                id :testi       

        MDNavigationLayout:
            id : nav_layout

            MyScreenManager:
                on_current : main_box.remove_widget(tabs) 
                id: screen_manager

                BrowseScreen:
                    on_enter : app.store.store_sync(); main_box.add_widget(tabs, -1) ;tabs.switch_tab(app.last_tab)
                    name : "bro_screen"
                    id: bro_screen                   
                PrefScreen:
                    on_enter : main_box.add_widget(tabs, -1) ; tabs.switch_tab(app.last_tab)
                    name : "pre_screen"
                    id : pre_screen
                ImageScreen:
                    on_enter : app.create_res_tbar()
                    name : "img_screen"
                    id : img_screen
                VideoScreen:
                    on_enter : app.create_res_tbar()
                    name : "vid_screen"
                    id : vid_screen
                AudioScreen:
                    on_enter : app.create_res_tbar()
                    name : "aud_screen"
                    id : aud_screen
                TextScreen:
                    on_enter : app.create_res_tbar()                
                    name : "txt_screen"
                    id : txt_screen

            MDNavigationDrawer:

                id: nav_drawer
                radius: (0, 16, 16, 0)
                on_state : app.store.store_load();print("touch",str(len(app.store["preferiti"])) );pref_indicator.right_text = str(len(app.store["preferiti"]))

                MDNavigationDrawerMenu:


                    MDNavigationDrawerHeader:
                        title: "SDE"
                        title_color: "#4a4939"
                        text: "Sardegna Digital Explorer"
                        spacing: "4dp"
                        padding: "12dp", 0, 0, "56dp"

          
                    DrawerClickableItem:
                        icon: "web"
                        text: "Esplora"
                        on_release:
                            app.previous = "bro_screen" 
                            screen_manager.current = "bro_screen"
                            nav_drawer.set_state("close")

                    DrawerClickableItem:
                        id : pref_indicator
                        icon: "star"
                        text: "Preferiti"
                        right_text: str(len(app.store["preferiti"]))
                        on_release: 
                            app.previous = "pre_screen" 
                            screen_manager.current = "pre_screen"
                            nav_drawer.set_state("close")

                    DrawerClickableItem:
                        icon: "reload"
                        text: "Ricarica Home"
                        on_release: 
                            app.reload_browser()
                            nav_drawer.set_state("close")



                    MDNavigationDrawerDivider:

                    DrawerLabelItem:
                        icon: "information-outline"
                        text: "Info"


